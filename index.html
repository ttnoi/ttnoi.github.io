<html class="h-100">

<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-D7FFXQWQ84"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-D7FFXQWQ84');
    </script>

    <title>Luyện phát âm cùng Tổng Thống Mỹ.</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="icon" type="image/x-icon" href="./images/favicon.png">
</head>

<body class="d-flex flex-column h-100">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <div class="container-fluid">
        <div class="row">
            <div class="col-none col-lg-3"></div>
            <div class="col-12 col-lg-6 center-block text-center">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col">
                            &nbsp; <!-- padding -->
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <input type="text" name="keyword" id="keyword">
                            <button id="search-button">Tìm kiếm</button>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            &nbsp; <!-- padding -->
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="container">
                                <div class="row">
                                    <div class="col-4">
                                        <input type="radio" name="speaker" id="donald-trump" class="speakerCheckbox"
                                            value="donaldtrump" checked="true">
                                        <label>Donald Trump</label>
                                    </div>

                                    <div class="col-4">
                                        <input type="radio" name="speaker" id="barack-obama" class="speakerCheckbox"
                                            value="barackobama">
                                        <label>Barack Obama</label>
                                    </div>

                                    <div class="col-4">
                                        <input type="radio" name="speaker" id="hillary-clinton" class="speakerCheckbox"
                                            value="hillaryclinton">
                                        <label>Hillary Clinton</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            &nbsp; <!-- padding -->
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <!-- 1. The widget will replace this <div> tag. -->
                            <div id="search-content"></div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col">
                            &nbsp;
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div id="GATA-suggestion" style="background-color: rgba(0, 0, 0, 0.05);"
                                class="jumbotron d-none">
                                <!-- The GATA suggestion system here -->
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            &nbsp;
                        </div>
                    </div>
                    <div class="row">
                        <div class="col border-bottom my-4 text-start">
                            <h2 style="color:orange;" id="comment-title">Bình luận cách phát âm từ vựng 'free':</h2>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div id="share">
                                <span id="share-url"></span>&nbsp;<button id="share-button">Copy để chia sẻ</button>
                            </div>
                            <div class="alert alert-success d-none" id="success-copying-alert" role="alert">
                                <strong>Đã copy url.</strong>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col">
                            &nbsp;
                        </div>
                    </div>

                    <div class="row">
                        <div id="comment-system" class="col">
                            <!-- The comment system here -->
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            &nbsp;
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-none col-lg-3"></div>
        </div>

    </div>
    <footer class="pt-5 px-5" style="background-color: rgba(0, 0, 0, 0.05);">
        <div class="row">
            <div class="col-12 col-md-2 mb-3">
                <h5>Mục lục</h5>
                <ul class="nav flex-column">
                    <li class="nav-item mb-2"><a href="https://ttnoi.com/" class="nav-link p-0 text-muted">Trang chủ</a>
                    </li>
                    <li class="nav-item mb-2"><a href="https://ttnoi.com/examples.html"
                            class="nav-link p-0 text-muted">Từ vựng phổ thông</a></li>
                </ul>
            </div>
            <div class="col-12 col-md-3 mb-3">
                <h5>Sản phẩm khác</h5>
                <ul class="nav flex-column">
                    <li class="nav-item mb-2"><a href="https://bit.ly/gata-on-google-play-6382"
                            class="nav-link p-0 text-muted">GATA: Học phát âm tiếng Anh</a></li>
                </ul>
            </div>

            <div class="col-12 col-md-5 offset-md-2 mb-3">
                <form>
                    <h5>Bạn mất gốc kỹ thuật phát âm?</h5>
                    <p>Tải ứng dụng GATA về học luôn nhé!</p>
                    <div class="d-flex flex-column flex-sm-row w-100 gap-2">
                        <a href="https://bit.ly/gata-on-google-play-6382" class="btn btn-primary" role="button">Google
                            Play</a>
                        <div data-toggle="tooltip" data-placement="bottom" title="Chưa hỗ trợ">
                            <a class="btn btn-secondary disabled" role="button" aria-disabled="true">App Store</a>
                        </div>

                    </div>
                </form>
            </div>
        </div>
        <div class="d-flex flex-column flex-sm-row justify-content-between pt-4 border-top">
            <p>© 2024 Bản quyền:
                <a class="text-body" href="https://ttnoi.com/">ttnoi.com</a>
            </p>
        </div>
    </footer>
    <script>
        const WEBSITE_URL = "https://ttnoi.com";
        const GATA_ON_GOOGLE_PLAY_URL = "https://bit.ly/gata-on-google-play-6381";

        // 2. This code loads the widget API code asynchronously.
        var tag = document.createElement('script');

        tag.src = "https://youglish.com/public/emb/widget.js";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        // 3. This function creates a widget after the API code downloads.
        var widget;
        function onYouglishAPIReady() {
            widget = new YG.Widget("search-content", {
                components: 8 + 16 + 64 + 128 + 512, //caption(8), Speed controls(16), Control Buttons(64), Dictionary support(128), Phonetic panel(512)
                events: {
                    'onFetchDone': onYouglishFetchDone
                }
            })
        }

        // 4. Process the query
        function search(keyword, speaker) {
            // 4.1 Fetch the result from Youglish
            widget.fetch(keyword + " #" + speaker, "english", "us");

            hidenCommentTitle();
            hidenShareUrl();
            hidenCommentSystem();
        }

        function onYouglishFetchDone(event) {
            var query = event.query;
            var args = query.split("#");
            var queriedKeyword = args[0].trim();
            if (args.length >= 2) {
                var queriedSpeaker = args[1].trim();
            } else {
                var queriedSpeaker = null;
            }

            // 4.2 Change title
            document.title = keyword + ": Luyện phát âm cùng Tổng Thống Mỹ."

            // 4.3 Load GATA suggestion
            // updateGATASuggestion(keyword);

            changeCommentTitle(queriedKeyword);

            // 4.4 Change share url
            updateShareUrl(queriedKeyword, queriedSpeaker);

            // 4.5 Load comment system
            loadCommentSystem(queriedKeyword);

            // 4.6 Set a cookie for reusing
            setCookie("keyword", queriedKeyword, 30);
            if (queriedSpeaker) {
                setCookie("speaker", queriedSpeaker, 30);
            }
        }

        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })

        // Querying when user 
        window.onload = function () {
            const queryString = window.location.search;
            const urlParams = new URLSearchParams(queryString);
            var preDefinedKeyword = urlParams.get('keyword');
            var preDefinedSpeaker = urlParams.get('speaker');

            if (preDefinedKeyword == null || preDefinedKeyword == "") {
                var cKeyword = getCookie("keyword");
                if (cKeyword != null && cKeyword != "") {
                    preDefinedKeyword = cKeyword;
                }
            }
            if (preDefinedSpeaker == null || preDefinedSpeaker == "") {
                var cSpeaker = getCookie("speaker");
                if (cSpeaker != null && cSpeaker != "") {
                    preDefinedSpeaker = cSpeaker;
                } else {
                    preDefinedSpeaker = "donaldtrump";
                }
            }

            switch (preDefinedSpeaker) {
                case "donaldtrump":
                    document.getElementById("donald-trump").checked = true;
                    break;
                case "barackobama":
                    document.getElementById("barack-obama").checked = true;
                    break;
                case "hillaryclinton":
                    document.getElementById("hillary-clinton").checked = true;
                    break;
            }

            if (preDefinedKeyword != null && preDefinedKeyword != "") {
                document.getElementById("keyword").value = preDefinedKeyword;
                document.getElementById("search-button").click();
            } else {
                document.getElementById("keyword").value = "free";
                document.getElementById("search-button").click();
            }
        }

        // Querying when user presses "enter" on the keyword textbox.
        document.getElementById("keyword").addEventListener("keydown", function (event) {
            if (event.key === "Enter") {
                document.getElementById("search-button").click();
            }
        });


        // Querying when user presses the "Tim kiem" button.
        document.getElementById("search-button").onclick = function () {
            var keyword = document.getElementById("keyword").value;
            var speaker = document.querySelector('.speakerCheckbox:checked').value;
            if (keyword != null && keyword != "" && speaker != null) {
                search(keyword, speaker);
            }
        };

        // Querying when user rechecks to other checkbox.
        document.getElementById('donald-trump').onclick = function () {
            document.getElementById("search-button").click();
        };
        document.getElementById('barack-obama').onclick = function () {
            document.getElementById("search-button").click();
        };
        document.getElementById('hillary-clinton').onclick = function () {
            document.getElementById("search-button").click();
        };

        // Click share button
        document.getElementById("share-button").onclick = function () {
            var shareUrl = document.getElementById("share-url");
            navigator.clipboard.writeText(shareUrl.textContent);

            document.getElementById("success-copying-alert").classList.remove("d-none");
            $("#success-copying-alert").fadeTo(2000, 500).slideUp(500, function () {
                $("#success-copying-alert").slideUp(500);
            });
        }

        function hidenCommentTitle() {
            const commentTitleTag = document.getElementById("comment-title");
            if (!commentTitleTag.classList.contains("d-none")) {
                commentTitleTag.classList.add("d-none");
            }
        }

        function changeCommentTitle(keyword) {
            const commentTitleTag = document.getElementById("comment-title");
            if (commentTitleTag.classList.contains("d-none")) {
                commentTitleTag.classList.remove("d-none");
            }

            commentTitleTag.innerText = "Bình luận cách phát âm từ vựng '" + keyword + "':"
        }

        function hidenShareUrl() {
            const shareTag = document.getElementById("share");
            if (!shareTag.classList.contains("d-none")) {
                shareTag.classList.add("d-none");
            }
        }

        function updateShareUrl(keyword, speaker) {
            const shareTag = document.getElementById("share");
            if (shareTag.classList.contains("d-none")) {
                shareTag.classList.remove("d-none");
            }

            if (speaker) {
                var url = WEBSITE_URL + "?speaker=" + speaker + "&keyword=" + keyword;
            } else {
                var url = WEBSITE_URL + "?keyword=" + keyword;
            }

            document.getElementById("share-url").textContent = url;
        }

        function updateGATASuggestion(keyword) {

            var GATASuggestion = document.getElementById('GATA-suggestion');
            while (GATASuggestion.firstChild) {
                GATASuggestion.removeChild(GATASuggestion.firstChild);
            }

            var [phonetics, suggestionList] = loadSuggestionLib(keyword);
            if (suggestionList && suggestionList.length > 0) {
                if (GATASuggestion.classList.contains("d-none")) {
                    GATASuggestion.classList.remove("d-none");
                }

                // <h1 class="display-4">hello - /həˈləʊ/</h1>
                titleTag = document.createElement("h6");
                titleTag.classList.add("display-6")
                titleContent = document.createTextNode(keyword + "  /" + phonetics + "/");
                titleTag.appendChild(titleContent);
                GATASuggestion.appendChild(titleTag);

                // <p class="lead">Âm /ə/ luôn giữ vai trò thứ âm.</p>
                suggestionList.forEach(suggestion => {
                    var suggestionTag = document.createElement("p");
                    suggestionTag.classList.add("lead");
                    var suggestionText = document.createTextNode(suggestion);
                    suggestionTag.appendChild(suggestionText);
                    GATASuggestion.appendChild(suggestionTag)
                });

                // <hr class="my-4">
                var hrTag = document.createElement("hr");
                hrTag.classList.add("my-4");
                GATASuggestion.appendChild(hrTag);

                // <p>Trích nối dung trong ứng dụng GATA: Học phát âm tiếng Anh.</p>
                var suggestionDescTag = document.createElement("p");
                var suggestionDescText = document.createTextNode("Trích nội dung trong ứng dụng GATA: Học phát âm tiếng Anh.");
                suggestionDescTag.appendChild(suggestionDescText);
                GATASuggestion.appendChild(suggestionDescTag);

                //  <p class="lead">
                //      <button id = "">GATA trên Google Play</button>
                //  </p>
                var actionTag = document.createElement("p");
                actionTag.classList.add("lead");
                actionTag.classList.add("my-4");
                var buttonTag = document.createElement("button");
                buttonTag.onclick = function () {
                    window.open(GATA_ON_GOOGLE_PLAY_URL, '_blank').focus();
                }
                buttonTag.id = "gata-google-play";
                var buttonText = document.createTextNode("GATA trên Google Play");
                buttonTag.appendChild(buttonText);
                actionTag.appendChild(buttonTag);
                GATASuggestion.appendChild(actionTag);

            } else {
                if (!GATASuggestion.classList.contains("d-none")) {
                    GATASuggestion.classList.add("d-none");
                }
            }
        }

        function loadSuggestionLib(keyword) {
            var proDict = {
                hello: "həˈləʊ",
                love: "lʌv",
            }
            var suggestionDict = {
                ə: "Âm /ə/ luôn phát âm với vai trò thứ âm - không phải trọng âm.",
                v: "Âm /v/ abc",
            }
            var suggestionList = [];

            var phonetics = proDict[keyword];
            if (phonetics && phonetics != "") {
                phonemeList = tokenizer(phonetics);
                if (phonemeList && phonemeList.length > 0) {
                    phonemeList.forEach(phoneme => {
                        var suggestion = suggestionDict[phoneme];
                        if (suggestion != null && suggestion != "") {
                            suggestionList.push(suggestion);
                        }
                    });
                }
            }

            return [phonetics, suggestionList];
        }

        function tokenizer(phonetics) {
            return ["h", "ə", "l", "əʊ"];
        };

        function hidenCommentSystem() {
            var commentSystemTag = document.getElementById("comment-system");
            while (commentSystemTag.firstChild) {
                commentSystemTag.removeChild(commentSystemTag.firstChild);
            }
        }

        function loadCommentSystem(keyword) {
            var commentSystemTag = document.getElementById("comment-system");
            while (commentSystemTag.firstChild) {
                commentSystemTag.removeChild(commentSystemTag.firstChild);
            }

            // <div id="disqus_thread"></div>
            var disqusThreadTag = document.createElement("div");
            disqusThreadTag.id = "disqus_thread";
            commentSystemTag.appendChild(disqusThreadTag);

            // var disqus_config = function () {
            // this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
            // this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
            // };
            var disqusScriptTag = document.createElement("script");
            disqusScriptTag.innerHTML =
                "var disqus_config = function () {" +
                "this.page.url = '" + WEBSITE_URL + "?keyword=" + keyword + "'" + ";" +
                "this.page.identifier = '" + keyword + "';" +
                "};" +
                "(function() {" +
                "var d = document, s = d.createElement('script');" +
                "s.src = 'https://ttnoi.disqus.com/embed.js';" +
                "s.setAttribute('data-timestamp', +new Date());" +
                "(d.head || d.body).appendChild(s);" +
                "})();";
            commentSystemTag.appendChild(disqusScriptTag);

        }

        function setCookie(cname, cvalue, exdays) {
            const d = new Date();
            d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
            let expires = "expires=" + d.toUTCString();
            document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
        }

        function getCookie(cname) {
            let name = cname + "=";
            let decodedCookie = decodeURIComponent(document.cookie);
            let ca = decodedCookie.split(';');
            for (let i = 0; i < ca.length; i++) {
                let c = ca[i];
                while (c.charAt(0) == ' ') {
                    c = c.substring(1);
                }
                if (c.indexOf(name) == 0) {
                    return c.substring(name.length, c.length);
                }
            }
            return "";
        }
    </script>
</body>

</html>